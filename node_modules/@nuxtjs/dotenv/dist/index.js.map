{"version":3,"file":"index.js","sources":["../node_modules/dotenv/lib/main.js","../src/index.js"],"sourcesContent":["'use strict'\n\nconst fs = require('fs')\nconst path = require('path')\n\n/*\n * Parses a string or buffer into an object\n * @param {(string|Buffer)} src - source to be parsed\n * @returns {Object} keys and values from src\n*/\nfunction parse (src) {\n  const obj = {}\n\n  // convert Buffers before splitting into lines and processing\n  src.toString().split('\\n').forEach(function (line) {\n    // matching \"KEY' and 'VAL' in 'KEY=VAL'\n    const keyValueArr = line.match(/^\\s*([\\w\\.\\-]+)\\s*=\\s*(.*)?\\s*$/)\n    // matched?\n    if (keyValueArr != null) {\n      const key = keyValueArr[1]\n\n      // default undefined or missing values to empty string\n      let value = keyValueArr[2] || ''\n\n      // expand newlines in quoted values\n      const len = value ? value.length : 0\n      if (len > 0 && value.charAt(0) === '\"' && value.charAt(len - 1) === '\"') {\n        value = value.replace(/\\\\n/gm, '\\n')\n      }\n\n      // remove any surrounding quotes and extra spaces\n      value = value.replace(/(^['\"]|['\"]$)/g, '').trim()\n\n      obj[key] = value\n    }\n  })\n\n  return obj\n}\n\n/*\n * Main entry point into dotenv. Allows configuration before loading .env\n * @param {Object} options - options for parsing .env file\n * @param {string} [options.path=.env] - path to .env file\n * @param {string} [options.encoding=utf8] - encoding of .env file\n * @returns {Object} parsed object or error\n*/\nfunction config (options) {\n  let dotenvPath = path.resolve(process.cwd(), '.env')\n  let encoding = 'utf8'\n\n  if (options) {\n    if (options.path) {\n      dotenvPath = options.path\n    }\n    if (options.encoding) {\n      encoding = options.encoding\n    }\n  }\n\n  try {\n    // specifying an encoding returns a string instead of a buffer\n    const parsed = parse(fs.readFileSync(dotenvPath, { encoding }))\n\n    Object.keys(parsed).forEach(function (key) {\n      if (!process.env.hasOwnProperty(key)) {\n        process.env[key] = parsed[key]\n      }\n    })\n\n    return { parsed }\n  } catch (e) {\n    return { error: e }\n  }\n}\n\nmodule.exports.config = config\nmodule.exports.load = config\nmodule.exports.parse = parse\n","import { readFileSync, accessSync, constants as fsconstants } from 'fs'\nimport { join } from 'path'\nimport { parse } from 'dotenv'\n\nexport default function DotEnvModule (moduleOptions) {\n  const defaultOptions = {\n    only: [],\n    path: this.options.srcDir\n  }\n\n  const options = Object.assign({}, defaultOptions, moduleOptions)\n\n  const envFilePath = join(options.path, '/.env')\n  try {\n    accessSync(envFilePath, fsconstants.R_OK)\n  } catch (err) {\n    // file not found, just return\n    return\n  }\n  const envConfig = parse(readFileSync(envFilePath))\n\n  const isAllowed = key => {\n    return options.only.length === 0 || options.only.includes(key)\n  }\n\n  Object.keys(envConfig).forEach((key) => {\n    if (isAllowed(key)) {\n      this.options.env[key] = this.options.env[key] || envConfig[key]\n    }\n  })\n}\n"],"names":["DotEnvModule","moduleOptions","defaultOptions","options","srcDir","Object","assign","envFilePath","join","path","fsconstants","R_OK","err","envConfig","parse","readFileSync","isAllowed","only","length","includes","key","keys","forEach","env"],"mappings":";;;;;;;;;;;;;;AAUA,SAAS,KAAK,EAAE,GAAG,EAAE;EACnB,MAAM,GAAG,GAAG,GAAE;;;EAGd,GAAG,CAAC,QAAQ,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,UAAU,IAAI,EAAE;;IAEjD,MAAM,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,iCAAiC,EAAC;;IAEjE,IAAI,WAAW,IAAI,IAAI,EAAE;MACvB,MAAM,GAAG,GAAG,WAAW,CAAC,CAAC,EAAC;;;MAG1B,IAAI,KAAK,GAAG,WAAW,CAAC,CAAC,CAAC,IAAI,GAAE;;;MAGhC,MAAM,GAAG,GAAG,KAAK,GAAG,KAAK,CAAC,MAAM,GAAG,EAAC;MACpC,IAAI,GAAG,GAAG,CAAC,IAAI,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,KAAK,GAAG,IAAI,KAAK,CAAC,MAAM,CAAC,GAAG,GAAG,CAAC,CAAC,KAAK,GAAG,EAAE;QACvE,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,OAAO,EAAE,IAAI,EAAC;OACrC;;;MAGD,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,gBAAgB,EAAE,EAAE,CAAC,CAAC,IAAI,GAAE;;MAElD,GAAG,CAAC,GAAG,CAAC,GAAG,MAAK;KACjB;GACF,EAAC;;EAEF,OAAO,GAAG;CACX;;AAwCD,WAAoB,GAAG,KAAK;;AC1Eb,SAASA,YAAT,CAAuBC,aAAvB,EAAsC;;;MAC7CC,iBAAiB;UACf,EADe;UAEf,KAAKC,OAAL,CAAaC;GAFrB;;MAKMD,UAAUE,OAAOC,MAAP,CAAc,EAAd,EAAkBJ,cAAlB,EAAkCD,aAAlC,CAAhB;;MAEMM,cAAcC,UAAKL,QAAQM,IAAb,EAAmB,OAAnB,CAApB;MACI;kBACSF,WAAX,EAAwBG,aAAYC,IAApC;GADF,CAEE,OAAOC,GAAP,EAAY;;;;MAIRC,YAAYC,QAAMC,gBAAaR,WAAb,CAAN,CAAlB;;MAEMS,YAAY,SAAZA,SAAY,MAAO;WAChBb,QAAQc,IAAR,CAAaC,MAAb,KAAwB,CAAxB,IAA6Bf,QAAQc,IAAR,CAAaE,OAAb,CAAsBC,GAAtB,CAA7B,OAAP;GADF;;SAIOC,IAAP,CAAYR,SAAZ,EAAuBS,OAAvB,CAA+B,UAACF,GAAD,EAAS;QAClCJ,UAAUI,GAAV,CAAJ,EAAoB;YACbjB,OAAL,CAAaoB,GAAb,CAAiBH,GAAjB,IAAwB,MAAKjB,OAAL,CAAaoB,GAAb,CAAiBH,GAAjB,KAAyBP,UAAUO,GAAV,CAAjD;;GAFJ;;;;;"}